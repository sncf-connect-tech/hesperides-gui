<!--
  ~ /*
  ~  * This file is part of the Hesperides distribution.
  ~  * (https://github.com/voyages-sncf-technologies/hesperides)
  ~  * Copyright (c) 2016 VSCT.
  ~  *
  ~  * Hesperides is free software: you can redistribute it and/or modify
  ~  * it under the terms of the GNU General Public License as
  ~  * published by the Free Software Foundation, version 3.
  ~  *
  ~  * Hesperides is distributed in the hope that it will be useful, but
  ~  * WITHOUT ANY WARRANTY; without even the implied warranty of
  ~  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  ~  * General Public License for more details.
  ~  *
  ~  * You should have received a copy of the GNU General Public License
  ~  * along with this program. If not, see <http://www.gnu.org/licenses/>.
  ~  */
  ~
  -->

<div>&nbsp;</div>
<div layout="row">
    <div flex="100">
        <div class="bg-light">
            <div layout="row" layout-align="space-between">
                <div layout="row" flex="75">
                    <h3>{{ 'properties.application.title' | translate }} <strong>{{application.name}}</strong></h3>
                    <md-button ng-click="isPlatformOpen = 0" ng-show="isPlatformOpen === 1" class="md-mini">
                        <span class="fa fa-compress"></span>
                        <md-tooltip>{{ 'properties.platform.hide.all' | translate }}</md-tooltip>
                    </md-button>
                    <md-button ng-click="isPlatformOpen = 1" ng-show="isPlatformOpen === 0" class="md-mini">
                        <span class="fa fa-expand"></span>
                        <md-tooltip>{{ 'properties.platform.show.all' | translate }}</md-tooltip>
                    </md-button>
                    <md-input-container ng-show="isPlatformOpen" class="md-block filter-platform width-50-pc">
                        <label>{{ 'properties.platform.search' | translate }}</label>
                        <input id="properties_platform-filter-input" type="text" ng-trim="true" ng-model="searchInPlatforms"
                               placeholder="{{ 'properties.platform.filter.placeholder' | translate }}"/>
                    </md-input-container>
                </div>
                <!--<div layout="row" flex>
                    <md-input-container>
                        <label>{{ 'properties.platform.restore.label' | translate }}</label>
                        <input type="text" ng-trim="true" ng-model="platformToRestore"
                               placeholder="{{ 'platform.modal.platformName' | translate }}"/>
                    </md-input-container>
                    <md-button ng-click="restore_platform(platformToRestore)" class="md-mini md-raised">{{ 'properties.platform.restore.try' | translate }}</md-button>
                </div>-->
            </div>
            <div ng-show="isPlatformOpen" class="file-content ng-hide" layout="column" flex="100">
                <list-of-items items="platforms"
                               label="$item.name + ' [' + $item.application_version + ']'"
                               filter="searchInPlatforms"
                               sorton="$item.name"
                               selected-item="platform"
                               onedit="on_edit_platform($item)"
                               selectable="true"
                               editable="false"
                               css="md-warn"
                               tooltip="{{ 'properties.platform.selection.tooltip' | translate }}"
                               size="small">
                </list-of-items>
            </div>
        </div>
    </div>
</div>

<div layout="column" ng-show="platform" class="bg-light">
    <div layout="row">
        <div flex="50">
            <h3>{{ 'properties.platform.title' | translate }} <strong>{{platform.name}} (version
                <a href="" ng-click="change_platform_version(platform)"
                   class="ng-binding"
                   onaftersave="save_platform_from_box(mainBox)">{{platform.application_version}}</a>
                <md-tooltip>{{ 'properties.platform.version.tooltip' | translate }}</md-tooltip>
                )</strong>

                <!-- Show events for platform -->
                <md-button id="properties_show-platform-event-button" aria-label="{{ 'properties.platform.version.history' | translate }}"
                           ng-click="show_events(application, platform, 'platform')" class="md-xs">
                    <span class="fa fa-history fa-2x"></span>
                    <md-tooltip>{{ 'properties.platform.version.history' | translate }}</md-tooltip>
                </md-button>

                <!-- Show pending changes -->
                <md-button id="properties_show-local-change-button" aria-label="{{ 'properties.platform.localChange.pending' | translate }}"
                           ng-click="show_united_nations_modal()" class="md-xs" ng-if="platformLocalChangesCount() > 0">
                    <span class="fa fa-medkit fa-2x"></span>
                    <span class="title">{{ 'properties.platform.localChange.pending' | translate }} ( {{platformLocalChangesCount()}} ) </span>
                </md-button>
            </h3>
        </div>
        <div flex="25" layout-align="center top">
            <h3>
                <md-switch id="properties_isProduction-switch" class="md-primary properties-production" aria-label="Production"
                           ng-model="platform.production" ng-disabled="!user.isProdUser" ng-change="save_platform_from_box(mainBox)" id="isProduction">
                    {{ 'properties.platform.production.switch' | translate }}
                    <md-tooltip>{{ 'properties.platform.production.switch.tooltip' | translate }}</md-tooltip>
                </md-switch>
            </h3>
        </div>
        <!-- 2019/05/13 Lucas: à restaurer lorsque les ACLs seront implémentées: div flex layout-align="center top">
            <h3>
                <md-button id="properties_delete-button" aria-label="{{ 'properties.platform.delete' | translate }}"
                           ng-really-click="delete_platform()" ng-really-message="{{ 'message.platform.delete.confirm' | translate }}" class="md-xs">
                    <span class="fa fa-trash fa-2x"></span>
                    <span class="title">{{ 'properties.platform.delete' | translate }}</span>
                </md-button>
            </h3>
        </div-->
    </div>
    <div layout="row" ng-show="empty_module_status()">
        <h4 class="contain_empty_module"><i class="fa fa-exclamation-triangle"></i>{{ 'properties.platform.emptyModule' | translate }}</h4>
    </div>
    <div layout="row">
        <div flex="none">
            <md-button id="properties_show-tree-mode-button" ng-click="treeModeShow()" ng-class="{'md-raised':tree}" aria-label="{{ 'properties.platform.treeMode.tooltip' | translate }}">
                <md-tooltip>{{ 'properties.platform.treeMode.tooltip' | translate }}</md-tooltip>
                <i class="fa fa-tree"></i>
            </md-button>
        </div>
        <div flex>
            <md-button id="e2e-properties-show-box-mode-button" ng-click="boxModeShow()" ng-class="{'md-raised':box}" aria-label="{{ 'properties.platform.boxMode.tooltip' | translate }}">
                <md-tooltip>{{ 'properties.platform.boxMode.tooltip' | translate }}</md-tooltip>
                <i class="fa fa-clone"></i>
            </md-button>
        </div>
    </div>

    <div id="box" class="slide-animate" ng-if="box" >
        <box-properties isInstanceOpen="isInstanceOpen"></box-properties>
    </div>
    <div id="tree" class="slide-animate" ng-if="tree">
        <tree-properties></tree-properties>
    </div>
</div>


